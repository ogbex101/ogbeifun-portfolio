{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 64, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/ogbeifun-portfolio/src/app/api/upload/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\r\nimport { writeFile } from 'fs/promises'\r\nimport { join } from 'path'\r\nimport { PrismaClient } from '@prisma/client'\r\n\r\nconst prisma = new PrismaClient()\r\n\r\nexport async function POST(request: NextRequest) {\r\n  try {\r\n    const formData = await request.formData()\r\n    const image = formData.get('image') as File\r\n    const projectId = formData.get('projectId') as string\r\n\r\n    if (!image || !projectId) {\r\n      return NextResponse.json(\r\n        { error: 'Image and project ID are required' },\r\n        { status: 400 }\r\n      )\r\n    }\r\n\r\n    const bytes = await image.arrayBuffer()\r\n    const buffer = Buffer.from(bytes)\r\n\r\n    // Create unique filename\r\n    const timestamp = Date.now()\r\n    const originalName = image.name\r\n    const extension = originalName.split('.').pop()\r\n    const filename = `project-${projectId}-${timestamp}.${extension}`\r\n    \r\n    // Save to public folder\r\n    const path = join(process.cwd(), 'public', 'project-images', filename)\r\n    await writeFile(path, buffer)\r\n\r\n    // Get existing images count for this project to set order\r\n    const existingImages = await prisma.projectImage.count({\r\n      where: { projectId }\r\n    })\r\n\r\n    // Save to database\r\n    await prisma.projectImage.create({\r\n      data: {\r\n        url: `/project-images/${filename}`,\r\n        altText: `Screenshot for project ${projectId}`,\r\n        order: existingImages,\r\n        projectId: projectId\r\n      }\r\n    })\r\n\r\n    return NextResponse.json({ success: true })\r\n  } catch (error) {\r\n    console.error('Error uploading image:', error)\r\n    return NextResponse.json(\r\n      { error: 'Failed to upload image' },\r\n      { status: 500 }\r\n    )\r\n  }\r\n}"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;;;;;AAEA,MAAM,SAAS,IAAI,6IAAY;AAExB,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,WAAW,MAAM,QAAQ,QAAQ;QACvC,MAAM,QAAQ,SAAS,GAAG,CAAC;QAC3B,MAAM,YAAY,SAAS,GAAG,CAAC;QAE/B,IAAI,CAAC,SAAS,CAAC,WAAW;YACxB,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAoC,GAC7C;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,QAAQ,MAAM,MAAM,WAAW;QACrC,MAAM,SAAS,OAAO,IAAI,CAAC;QAE3B,yBAAyB;QACzB,MAAM,YAAY,KAAK,GAAG;QAC1B,MAAM,eAAe,MAAM,IAAI;QAC/B,MAAM,YAAY,aAAa,KAAK,CAAC,KAAK,GAAG;QAC7C,MAAM,WAAW,CAAC,QAAQ,EAAE,UAAU,CAAC,EAAE,UAAU,CAAC,EAAE,WAAW;QAEjE,wBAAwB;QACxB,MAAM,OAAO,IAAA,yGAAI,EAAC,QAAQ,GAAG,IAAI,UAAU,kBAAkB;QAC7D,MAAM,IAAA,kIAAS,EAAC,MAAM;QAEtB,0DAA0D;QAC1D,MAAM,iBAAiB,MAAM,OAAO,YAAY,CAAC,KAAK,CAAC;YACrD,OAAO;gBAAE;YAAU;QACrB;QAEA,mBAAmB;QACnB,MAAM,OAAO,YAAY,CAAC,MAAM,CAAC;YAC/B,MAAM;gBACJ,KAAK,CAAC,gBAAgB,EAAE,UAAU;gBAClC,SAAS,CAAC,uBAAuB,EAAE,WAAW;gBAC9C,OAAO;gBACP,WAAW;YACb;QACF;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAK;IAC3C,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,0BAA0B;QACxC,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAyB,GAClC;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}